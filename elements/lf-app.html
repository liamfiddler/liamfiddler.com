<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="elements.html">
<dom-module id="lf-app">
	<template>
		<style>
			:host {
          display: block;
      }
      #container {
        position: relative;
        z-index: 2;
      }
      lf-trishapes {
        position: absolute;
        top: 0;
        left: 0;
        z-index: 1;
        width: 100%;
        height: 100%;
				opacity: .66;
      }
		</style>
    <div>
        <div id="container">
          <content></content>
        </div>
        <lf-trishapes id="trishapes"></lf-trishapes>
    </div>
	</template>
	<script>
		Polymer({
			is: 'lf-app',
			attached: function() {
				this._colorHyperlinks();
				this._revealText();
				this._redrawOnTimer();
			},
			_redrawOnTimer: function() {
				window.requestAnimFrame = (function() {
					return window.requestAnimationFrame ||
						window.webkitRequestAnimationFrame ||
						window.mozRequestAnimationFrame ||
						window.oRequestAnimationFrame ||
						window.msRequestAnimationFrame ||
						function(callback, element) {
						window.setTimeout(callback, 1000 / 60);
					};
				})();

				var start = new Date().getTime();
				var trishapes = this.$.trishapes;

				(function repeatOften() {
						var delta = (new Date().getTime()) - start;

						if(delta >= 8000) {
								trishapes.draw();
								start = new Date().getTime();
						}

						window.requestAnimFrame(repeatOften);
				})();
			},
			_colorHyperlinks: function() {
				var hyperlinks = Polymer.dom(this).querySelectorAll('a');

				var colors = [
					'#B22222',
					'#DAA520',
					'#6B8E23',
					'#4169E1',
				];

				for (var i = 0; i < hyperlinks.length; i++) {
					hyperlinks[i].style.color = colors[i % colors.length];
				}
			},
			_revealText: function() {
				var revealtext = Polymer.dom(this).querySelectorAll('lf-revealtext');
				var item;

			  for (var i = 0; i < revealtext.length; i++) {
					(function(item, delay) {
						setTimeout(function() {
							item.reveal();
						}, delay);
					})(revealtext[i], 100 * (i + 3));
			  }
			},
		});
	</script>
</dom-module>
